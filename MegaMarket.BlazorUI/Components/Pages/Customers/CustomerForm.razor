@using MegaMarket.BlazorUI.Services.CustomerLoyalty

<div class="form-group">
    <label for="fullName" class="form-label">Full Name <span class="text-danger">*</span></label>
    <input type="text" class="form-control @(string.IsNullOrEmpty(Customer?.FullName) ? "is-invalid" : "")" 
           id="fullName" @bind="Customer!.FullName" placeholder="Enter full name" />
    @if (string.IsNullOrEmpty(Customer?.FullName))
    {
        <div class="invalid-feedback d-block">Full name is required</div>
    }
</div>

<div class="form-group mt-3">
    <label for="phone" class="form-label">Phone <span class="text-danger">*</span></label>
    <input type="tel" class="form-control @(string.IsNullOrEmpty(Customer?.Phone) ? "is-invalid" : "")" 
           id="phone" @bind="Customer!.Phone" placeholder="0123456789" />
    @if (string.IsNullOrEmpty(Customer?.Phone))
    {
        <div class="invalid-feedback d-block">Phone is required</div>
    }
</div>

<div class="form-group mt-3">
    <label for="email" class="form-label">Email</label>
    <input type="email" class="form-control" id="email" @bind="Customer!.Email" placeholder="email@example.com" />
</div>

<div class="form-group mt-3">
    <label for="points" class="form-label">Points</label>
    <input type="number" class="form-control" id="points" @bind="Customer!.Points" min="0" />
</div>

@if (IsEditing)
{
    <div class="form-group mt-3">
        <label for="rank" class="form-label">Rank</label>
        <select class="form-select" id="rank" @bind="Customer!.Rank">
            <option value="">Select Rank</option>
            <option value="Silver">Silver</option>
            <option value="Gold">Gold</option>
            <option value="Platinum">Platinum</option>
        </select>
    </div>
}

<div class="d-flex gap-2 mt-4">
    <button class="btn btn-primary" @onclick="SubmitForm">
        @(IsEditing ? "Update" : "Add") Customer
    </button>
    <button class="btn btn-outline-secondary" @onclick="OnCancel">Cancel</button>
</div>

@code {
    [Parameter]
    public CustomerDto? Customer { get; set; }

    [Parameter]
    public bool IsEditing { get; set; }

    [Parameter]
    public EventCallback<CustomerDto> OnSubmit { get; set; }

    [Parameter]
    public EventCallback OnCancel { get; set; }

    private async Task SubmitForm()
    {
        if (Customer == null || string.IsNullOrEmpty(Customer.FullName) || string.IsNullOrEmpty(Customer.Phone))
        {
            return; // Form validation error shown above
        }

        await OnSubmit.InvokeAsync(Customer);
    }
}
